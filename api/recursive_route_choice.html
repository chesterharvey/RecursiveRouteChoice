

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>recursive_route_choice module &mdash; RecursiveRouteChoice 0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="optimisers package" href="optimisers.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> RecursiveRouteChoice
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Introduction &amp; Overview:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../source/introduction_install.html">1. Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/introduction_install.html#installation">2. Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/simple_example.html">3. A Simple Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../source/data_formats.html">4. Data Format Support</a></li>
</ul>
<p class="caption"><span class="caption-text">API Reference:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_loading.html">data_loading module</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_processing.html">data_processing module</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimisers.html">optimisers package</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">recursive_route_choice module</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">RecursiveRouteChoice</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>recursive_route_choice module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/recursive_route_choice.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-recursive_route_choice">
<span id="recursive-route-choice-module"></span><h1>recursive_route_choice module<a class="headerlink" href="#module-recursive_route_choice" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="recursive_route_choice.ModelDataStruct">
<em class="property">class </em><code class="sig-prename descclassname">recursive_route_choice.</code><code class="sig-name descname">ModelDataStruct</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_attribute_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>scipy.sparse.dok.dok_matrix<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">incidence_matrix</span><span class="p">:</span> <span class="n">scipy.sparse.dok.dok_matrix</span></em>, <em class="sig-param"><span class="n">data_array_names_debug</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resize</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.ModelDataStruct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Generic struct which stores all the arc attributes together in a convenient manner.
Additionally, if it hasn’t already been done, the input data is padded with an additional
row/ col to bottom right which will have the destination dummy arc mapped to.
This is perhaps not particularly, clear but it is done here to avoid having to
resize all the dependent quantities later</p>
<dl class="py method">
<dt id="recursive_route_choice.ModelDataStruct.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_attribute_list</span><span class="p">:</span> <span class="n">List<span class="p">[</span>scipy.sparse.dok.dok_matrix<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">incidence_matrix</span><span class="p">:</span> <span class="n">scipy.sparse.dok.dok_matrix</span></em>, <em class="sig-param"><span class="n">data_array_names_debug</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">resize</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.ModelDataStruct.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiate a ModelDataStruct instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_attribute_list</strong> (list of <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.dok_matrix.html#scipy.sparse.dok_matrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.dok_matrix</span></code></a> or list of array like) – List of all network attribute matrices</p></li>
<li><p><strong>incidence_matrix</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.dok_matrix.html#scipy.sparse.dok_matrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.dok_matrix</span></code></a> or array like) – Network incidence matrix</p></li>
<li><p><strong>data_array_names_debug</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of plaintext descriptors for the network attributes, used for debug printing</p></li>
<li><p><strong>resize</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to resize matrix to include zero column for dest. Should be True, unless you
know what you are doing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="recursive_route_choice.RecursiveLogitModel">
<em class="property">class </em><code class="sig-prename descclassname">recursive_route_choice.</code><code class="sig-name descname">RecursiveLogitModel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_struct</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct">recursive_route_choice.ModelDataStruct</a></span></em>, <em class="sig-param"><span class="n">initial_beta</span><span class="o">=</span><span class="default_value">- 1.5</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.8)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a></p>
<p>Abstraction of the linear algebra operations for the recursive logit
model to solve the matrix system for the value functions.</p>
<p>Is subclassed to provide functionality for prediction and estimation and
should not be directly instantiated</p>
<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModel.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_struct</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct">recursive_route_choice.ModelDataStruct</a></span></em>, <em class="sig-param"><span class="n">initial_beta</span><span class="o">=</span><span class="default_value">- 1.5</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialises a RecursiveLogitModel instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_struct</strong> (<a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct"><em>ModelDataStruct</em></a>) – The ModelDataStruct corresponding to the network being estimated on</p></li>
<li><p><strong>initial_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>] or </em><em>array_like</em>) – The initial value for the parameter weights of the network attributes</p></li>
<li><p><strong>mu</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The scale parameter of the Gumbel random variables being modelled. Generally set
equal to 1 as it is non-identifiable due to the uncertainty in the parameter weights.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModel.compute_value_function">
<code class="sig-name descname">compute_value_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m_tilde</span></em>, <em class="sig-param"><span class="n">data_is_sparse</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel.compute_value_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Solves the linear system <span class="math notranslate nohighlight">\(z = Mz+b\)</span> and stores the output for future use.
Returns a boolean indicating if solving the linear system was successful or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m_tilde</strong> (<a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a>) – The matrix M modified to reflect the current location of the sink destination state.</p></li>
<li><p><strong>data_is_sparse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – flag to indicate if the data - in this case m_tilde is sparse. If supplied, we don’t
need to check this manually.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>error_flag</strong> – Returns True if an error was encountered, else false if execution finished
successfully. Errors are due to the linear system having no solution, high residual
or having negative solution, such that the value functions have no real solution.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModel.get_beta_vec">
<code class="sig-name descname">get_beta_vec</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel.get_beta_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current value of the network attribute parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>beta_vec</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code></a> of float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModel.get_exponential_utility_matrix">
<code class="sig-name descname">get_exponential_utility_matrix</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel.get_exponential_utility_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix of exponentiated short term utilities between all states for the current
value of beta.</p>
<p>In the mathematical notation this is <span class="math notranslate nohighlight">\([M_{s,a}]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>short_term_utility</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModel.get_short_term_utility">
<code class="sig-name descname">get_short_term_utility</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModel.get_short_term_utility" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the matrix of short term utilities between all states for the current value of beta.</p>
<p>In the mathematical notation this is <span class="math notranslate nohighlight">\([r(s,a)]\)</span> or <span class="math notranslate nohighlight">\([v(a|k)]\)</span> in the
notation of Fosgerau.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>short_term_utility</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.csr_matrix.html#scipy.sparse.csr_matrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.csr_matrix</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation">
<em class="property">class </em><code class="sig-prename descclassname">recursive_route_choice.</code><code class="sig-name descname">RecursiveLogitModelEstimation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_struct</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct">recursive_route_choice.ModelDataStruct</a></span></em>, <em class="sig-param"><span class="n">optimiser</span><span class="p">:</span> <span class="n"><a class="reference internal" href="optimisers.html#optimisers.optimisers_file.OptimiserBase" title="optimisers.optimisers_file.OptimiserBase">optimisers.optimisers_file.OptimiserBase</a></span></em>, <em class="sig-param"><span class="n">observations_record</span></em>, <em class="sig-param"><span class="n">initial_beta</span><span class="o">=</span><span class="default_value">- 1.5</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sort_obs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#recursive_route_choice.RecursiveLogitModel" title="recursive_route_choice.RecursiveLogitModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">recursive_route_choice.RecursiveLogitModel</span></code></a></p>
<p>Extension of <cite>RecursiveLogitModel</cite> to support Estimation of network attribute parameters.</p>
<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_struct</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct">recursive_route_choice.ModelDataStruct</a></span></em>, <em class="sig-param"><span class="n">optimiser</span><span class="p">:</span> <span class="n"><a class="reference internal" href="optimisers.html#optimisers.optimisers_file.OptimiserBase" title="optimisers.optimisers_file.OptimiserBase">optimisers.optimisers_file.OptimiserBase</a></span></em>, <em class="sig-param"><span class="n">observations_record</span></em>, <em class="sig-param"><span class="n">initial_beta</span><span class="o">=</span><span class="default_value">- 1.5</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sort_obs</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialise recursive logit model for estimation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_struct</strong> (<a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct"><em>ModelDataStruct</em></a>) – containing network attributes of desired network</p></li>
<li><p><strong>optimiser</strong> (<a class="reference internal" href="optimisers.html#optimisers.optimisers_file.ScipyOptimiser" title="optimisers.optimisers_file.ScipyOptimiser"><em>ScipyOptimiser</em></a><em> or </em><a class="reference internal" href="optimisers.html#optimisers.optimisers_file.LineSearchOptimiser" title="optimisers.optimisers_file.LineSearchOptimiser"><em>LineSearchOptimiser</em></a>) – The wrapper instance for the desired optimisation routine</p></li>
<li><p><strong>observations_record</strong> (ak.highlighlevel.Array or <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.sparse.spmatrix.html#scipy.sparse.spmatrix" title="(in SciPy v1.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">scipy.sparse.spmatrix</span></code></a> or list of list) – record of observations to estimate from</p></li>
<li><p><strong>initial_beta</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><em>array like</em>) – initial guessed values of beta to begin optimisation algorithm with. If a scalar,
beta are uniformly initialised to this value</p></li>
<li><p><strong>mu</strong> – The scale parameter of the Gumbel random variables being modelled. Generally set
equal to 1 as it is non-identifiable due to the uncertainty in the parameter weights.</p></li>
<li><p><strong>sort_obs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – flag to sort input observations to allow for efficient caching. Should only be set to
False if the data is large and already known to be sorted.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.eval_log_like_at_new_beta">
<code class="sig-name descname">eval_log_like_at_new_beta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">beta_vec</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.eval_log_like_at_new_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>update beta vec and compute log likelihood in one step - used for lambdas
Effectively a bad functools.partial</p>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.get_log_likelihood">
<code class="sig-name descname">get_log_likelihood</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.get_log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the log likelihood of the data  and its gradient for the current beta vec</p>
<p>Main purpose is to update internal state however also returns the negative of these two
quantities</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>log_like_stored</strong> (<em>float</em>) – The current negative log likelihood. Note that it is negative to be consistent
with a minimisation problem</p></li>
<li><p>self.grad_stored  <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code></a> of float – The current negative gradient of the log likelihood. Note that it is negative to be
consistent with a minimisation problem</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.get_value_func_grad_orig">
<code class="sig-name descname">get_value_func_grad_orig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">orig_index</span></em>, <em class="sig-param"><span class="n">m_tilde</span></em>, <em class="sig-param"><span class="n">exp_val_funcs</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.get_value_func_grad_orig" title="Permalink to this definition">¶</a></dt>
<dd><p>Note relies on ‘self’ for the attribute data.
Computes the gradient of the value function evaluated at the origin
Named GradValFnOrig in companion notes, see also GradValFn2 for component part
- this function applies the 1/z_{orig} * [rest]_{evaluated at orig}</p>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.solve_for_optimal_beta">
<code class="sig-name descname">solve_for_optimal_beta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">output_file</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.solve_for_optimal_beta" title="Permalink to this definition">¶</a></dt>
<dd><p>Executes the optimisation algorithm specified in the init to determine the most likely
parameter values based upon the input observations</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>verbose</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag for printing of output</p></li>
<li><p><strong>output_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>os.path.PathLike</em><em>, </em><em>optional</em>) – file to send verbose output to</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>beta_vec</strong> – The optimal determined vector of parameters</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelEstimation.update_beta_vec">
<code class="sig-name descname">update_beta_vec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_beta_vec</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelEstimation.update_beta_vec" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the interval value for the network parameters beta with the supplied value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_beta_vec</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.19)"><code class="xref py py-func docutils literal notranslate"><span class="pre">numpy.array()</span></code></a> of float) – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>error_flag</strong> – Returns a boolean flag to indicate if updating beta was successful. This fails for an
ill chosen beta which either is positive and illegal, or is large in magnitude such
that the short term utility calculation overflows.</p>
<p>This flag is likely not used by an end user, only the internal code</p>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.8)">bool</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="recursive_route_choice.RecursiveLogitModelPrediction">
<em class="property">class </em><code class="sig-prename descclassname">recursive_route_choice.</code><code class="sig-name descname">RecursiveLogitModelPrediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data_struct</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#recursive_route_choice.ModelDataStruct" title="recursive_route_choice.ModelDataStruct">recursive_route_choice.ModelDataStruct</a></span></em>, <em class="sig-param"><span class="n">initial_beta</span><span class="o">=</span><span class="default_value">- 1.5</span></em>, <em class="sig-param"><span class="n">mu</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelPrediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#recursive_route_choice.RecursiveLogitModel" title="recursive_route_choice.RecursiveLogitModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">recursive_route_choice.RecursiveLogitModel</span></code></a></p>
<p>Subclass which generates simulated observations based upon the supplied beta vector.
Uses same structure as estimator in the hopes I can unify these such that one can use the
estimator for prediction as well (probably have estimator inherit from this)</p>
<dl class="py method">
<dt id="recursive_route_choice.RecursiveLogitModelPrediction.generate_observations">
<code class="sig-name descname">generate_observations</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">origin_indices</span></em>, <em class="sig-param"><span class="n">dest_indices</span></em>, <em class="sig-param"><span class="n">num_obs_per_pair</span></em>, <em class="sig-param"><span class="n">iter_cap</span><span class="o">=</span><span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">rng_seed</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#recursive_route_choice.RecursiveLogitModelPrediction.generate_observations" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>origin_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><em>iterable</em>) – iterable of indices to start paths from</p></li>
<li><p><strong>dest_indices</strong> (<em>List</em><em> or </em><em>iterable</em>) – iterable of indices to end paths at</p></li>
<li><p><strong>num_obs_per_pair</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of observations to generate for each OD pair</p></li>
<li><p><strong>iter_cap</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – iteration cap in the case of non convergent value functions.
Hopefully should not occur but may happen if the value function solutions
are negative but ill conditioned.</p></li>
<li><p><strong>rng_seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em> or </em><em>np.random.BitGenerator</em><em>  (</em><em>any legal input to np.random.default_rng</em><em>(</em><em>)</em><em>)</em>) – Seed for numpy generator, or instance of np.random.BitGenerator</p></li>
</ul>
</dd>
</dl>
<p>:rtype list of list of int
:return List of list of all observations generated</p>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="optimisers.html" class="btn btn-neutral float-left" title="optimisers package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Matthew Richards

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>